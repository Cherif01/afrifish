<div class="container-fluid mt-4">
  <!-- Header avec titre et bouton -->
  <div class="card g-4">
    <div class="row">
      <div class="col text-start">
        <h4 class="text-uppercase fw-bold">{{ title }}</h4>
      </div>

    </div>
  </div>

  <div class="row g-4">
    <!-- Tableau -->
    <div class="col">
      <mat-card class="shadow-sm">
        <div class="table-responsive p-3">
          <h3 class="form-title text-center text-primary mb-3">
            Listes des Factures Pro Format
          </h3>
          <mat-form-field class="w-100 mb-3" appearance="outline">
            <mat-label>Rechercher...</mat-label>
            <input
              matInput
              (keyup)="applyFilter($event)"
              placeholder="Rechercher"
              #input
            />
          </mat-form-field>

          <table
            mat-table
            [dataSource]="dataSource"
            id="maTable"
            class="mat-elevation-z8"
          >
            <!-- Colonne ID -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef>#</th>
              <td mat-cell *matCellDef="let element; let i = index">
                {{ i + 1 }}
              </td>
            </ng-container>

            <!-- Colonne representant -->
            <ng-container matColumnDef="representant">
              <th mat-header-cell *matHeaderCellDef>Fournisseur</th>
              <td mat-cell *matCellDef="let element">
                {{ element.representant }} <br />
                <span class="text-blue">de : {{ element.raison_sociale }}</span>
                <br />
                <span class="text-red">{{ element.telephone }}</span>
              </td>
            </ng-container>

            <!-- Colonne Statut -->
            <ng-container matColumnDef="statut">
              <th mat-header-cell *matHeaderCellDef>Statut</th>
              <td mat-cell *matCellDef="let element">
                <span
                [ngClass]="{
                  'badge-valid': element.statut === 'en attente',
                  'badge-en-cours': element.statut === 'livrer',
                  'badge-livraison': element.statut === 'en livraison'
                }"
              >
                {{
                  element.statut === "en attente"
                    ? "en attente de confirmation"
                    : element.statut
                }}
              </span>

              </td>
            </ng-container>

            <!-- Colonne Date de création -->
            <ng-container matColumnDef="created_at">
              <th mat-header-cell *matHeaderCellDef>Fait le</th>
              <td mat-cell *matCellDef="let element">
                {{ element.created_at | date : "short" }}
              </td>
            </ng-container>



            <!-- Colonne Actions -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Actions</th>
              <td mat-cell *matCellDef="let element">
                <div class="d-flex gap-2 justify-content-center">
                  <button *ngIf="element.statut === 'en attente'"
                    mat-stroked-button
                    color="warn" class="mx-2"
                    routerLink="/operation/details-facture/{{ element.id }}"
                  >
                    <mat-icon>edit</mat-icon>
                  </button>
                  <button *ngIf="element.statut === 'en livraison'" class="mx-2" mat-stroked-button color="primary" (click)="validerCommande(element.id)">
                        <mat-icon class="mat-18">check</mat-icon>
                      </button>
                      <button  *ngIf="element.statut === 'livrer'" mat-stroked-button color="accent" routerLink="/stock/details-approvisionnement/{{ element.id }}">
                        <mat-icon>visibility</mat-icon>
                      </button>
                </div>
              </td>
            </ng-container>

            <!-- Ligne d'en-tête -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

            <!-- Ligne des données -->
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>

          <mat-paginator
            [pageSizeOptions]="[5, 10, 20]"
            showFirstLastButtons
          ></mat-paginator>
        </div>
      </mat-card>
    </div>
  </div>
</div>
